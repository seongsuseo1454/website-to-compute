<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mayor Smart Mirror - AI Test</title>
  <style>
    body { font-family: system-ui, -apple-system, Roboto, 'Noto Sans KR', sans-serif; background:#121212; color:#e7e7e7; padding:20px; }
    .card{ background:#1e1e1e; padding:16px; border-radius:10px; max-width:900px; margin:10px auto; }
    textarea{ width:100%; height:100px; background:#0f0f0f; color:#eee; border:1px solid #2b2b2b; padding:8px; border-radius:6px; }
    button{ padding:8px 12px; border-radius:8px; border:none; cursor:pointer; background:#3b82f6; color:white; }
    pre{ white-space:pre-wrap; background:#0b0b0b; padding:10px; border-radius:6px; color:#d6d6d6; }
  </style>
</head>
<body>
  <div class="card">
    <h2>AI 테스트 (Gemini)</h2>
    <label>프롬프트:</label>
    <textarea id="prompt">오늘 시장 일정 요약해줘</textarea>
    <div style="margin-top:10px;">
      <button id="send">AI 테스트</button>
      <button id="clear">결과 초기화</button>
    </div>
    <h3>결과</h3>
    <pre id="result">결과 대기중...</pre>
  </div>

  <script>
    async function askGemini(prompt){
      try{
        const res = await fetch('/api/ai', {
          method:'POST',
          headers:{ 'Content-Type':'application/json' },
          body: JSON.stringify({ prompt })
        });
        const j = await res.json();
        return j;
      }catch(e){
        return { error: String(e) };
      }
    }

    document.getElementById('send').addEventListener('click', async ()=>{
      const prompt = document.getElementById('prompt').value.trim();
      if(!prompt){ alert('프롬프트를 입력하세요'); return; }
      document.getElementById('result').textContent = '요청중...';
      const r = await askGemini(prompt);
      // 보기 쉬운 형태로 출력
      document.getElementById('result').textContent = JSON.stringify(r, null, 2);
    });

    document.getElementById('clear').addEventListener('click', ()=> {
      document.getElementById('result').textContent = '';
    });
  </script>
</body>
</html>
