<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>시장 집무실 스마트 미러 PRO</title>

  <!-- PWA -->
  <link rel="manifest" href="/manifest.webmanifest" />
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png" />
  <meta name="theme-color" content="#0b0f19" />

  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <header class="topbar">
    <div class="profile">
      <div class="avatar" aria-hidden="true"></div>
      <div class="greet">
        <div id="greeting">안녕하세요, 시장님</div>
        <div id="subtitle" class="muted">오늘도 좋은 하루 되세요.</div>
      </div>
    </div>
    <div class="meta">
      <div id="clock" class="clock">--:--</div>
      <div id="date" class="muted">YYYY.MM.DD (—)</div>
      <div id="weather" class="muted">날씨 가져오는 중...</div>
    </div>
  </header>

  <main class="grid">
    <!-- 중앙 건강 요약/AI 카드 -->
    <section class="card" id="ai-card">
      <h2>AI 비서</h2>

      <div class="chat">
        <div id="chat-log" class="chat-log" aria-live="polite"></div>

        <div class="chat-controls">
          <button id="mic-btn" class="btn" title="음성으로 말하기(토글)">🎤</button>
          <input id="chat-input" class="input" type="text" placeholder="지시사항을 말씀하거나 입력하세요…" />
          <button id="send-btn" class="btn primary">보내기</button>
        </div>

        <div class="tts-controls">
          <button id="speak-last" class="btn" title="마지막 답변 읽어주기">🔊 읽어주기</button>
          <button id="stop-speak" class="btn" title="음성 중지">⏹️ 중지</button>
        </div>

        <div id="hint" class="muted small">
          ※ 특수문자/마크다운/이모지 등은 음성 읽기 전에 자동 정리됩니다.
        </div>
      </div>
    </section>

    <!-- 오늘의 지혜 -->
    <section class="card" id="insight-card">
      <h2>오늘의 지혜</h2>
      <div id="insight-text" class="insight">“건강은 가장 큰 재산입니다.” — 버지니아 울프</div>
      <div class="row">
        <button id="read-insight" class="btn">🔊 명언 읽기</button>
        <button id="stop-insight" class="btn">⏹️ 중지</button>
      </div>
    </section>

    <!-- 상태/목표 -->
    <section class="card" id="status-card">
      <h2>오늘의 권장</h2>
      <ul id="ai-reco" class="list">
        <li>가벼운 스트레칭 10분</li>
        <li>물 8잔(하루)</li>
        <li>점심 후 15분 산책</li>
      </ul>
    </section>
  </main>

  <footer class="bottombar">
    <div>© 스마트 미러 PRO</div>
    <div class="muted small">PWA 설치: 브라우저 메뉴 &gt; 홈 화면에 추가</div>
  </footer>

  <script type="module" src="/ai.js"></script>
  <script>
    // PWA SW 등록
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js').catch(console.error);
    }
  </script>
</body>
</html>
